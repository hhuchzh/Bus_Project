(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-188cf304","chunk-2d216051","chunk-2d21f2d8"],{"2fec":function(e,t,n){},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,n){var r=n("1d80"),i=n("577e"),o=n("5899"),a="["+o+"]",c=RegExp("^"+a+a+"*"),s=RegExp(a+a+"*$"),u=function(e){return function(t){var n=i(r(t));return 1&e&&(n=n.replace(c,"")),2&e&&(n=n.replace(s,"")),n}};e.exports={start:u(1),end:u(2),trim:u(3)}},"6eba":function(e,t,n){var r=n("23e7");r({target:"Date",stat:!0},{now:function(){return(new Date).getTime()}})},7156:function(e,t,n){var r=n("861d"),i=n("d2bb");e.exports=function(e,t,n){var o,a;return i&&"function"==typeof(o=t.constructor)&&o!==n&&r(a=o.prototype)&&a!==n.prototype&&i(e,a),e}},a046:function(e,t,n){"use strict";n.r(t);var r=n("7a23");Object(r["Q"])("data-v-e950f0bc");var i={class:"search-term"},o=Object(r["r"])("早高峰查询"),a=Object(r["r"])("晚高峰查询"),c=Object(r["o"])("div",{id:"container",style:{width:"1600px",height:"750px"}},null,-1),s=Object(r["o"])("p",{style:{"text-align":"center"}},"没有历史轨迹数据，请重新查询",-1),u={class:"dialog-footer"},l=Object(r["r"])("确 定");function d(e,t,n,d,f,p){var b=Object(r["W"])("el-option"),h=Object(r["W"])("el-select"),m=Object(r["W"])("el-form-item"),I=Object(r["W"])("el-date-picker"),g=Object(r["W"])("el-button"),w=Object(r["W"])("el-form"),O=Object(r["W"])("el-dialog");return Object(r["N"])(),Object(r["n"])("div",null,[Object(r["o"])("div",i,[Object(r["s"])(w,{inline:!0,model:e.searchInfo,class:"demo-form-inline"},{default:Object(r["lb"])((function(){return[Object(r["s"])(m,{label:"车牌号:",prop:"busId"},{default:Object(r["lb"])((function(){return[Object(r["s"])(h,{modelValue:f.currentSelectedPlate,"onUpdate:modelValue":t[0]||(t[0]=function(e){return f.currentSelectedPlate=e}),placeholder:"请选择车牌号",onChange:t[1]||(t[1]=function(e){return p.changeOption(e)})},{default:Object(r["lb"])((function(){return[(Object(r["N"])(!0),Object(r["n"])(r["b"],null,Object(r["U"])(f.busInfoList,(function(e){return Object(r["N"])(),Object(r["l"])(b,{key:e.busPlate,label:e.busPlate,value:e.ID},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),Object(r["s"])(m,{label:"日期:",prop:"time"},{default:Object(r["lb"])((function(){return[Object(r["s"])(I,{modelValue:f.currentSelectedDate,"onUpdate:modelValue":t[2]||(t[2]=function(e){return f.currentSelectedDate=e}),placeholder:"请选择日期",type:"date","disabled-date":p.disabledDate,"value-format":"YYYY-MM-DD"},null,8,["modelValue","disabled-date"])]})),_:1}),Object(r["s"])(m,null,{default:Object(r["lb"])((function(){return[Object(r["s"])(g,{size:"mini",type:"primary",icon:"el-icon-search",onClick:t[3]||(t[3]=function(e){return p.onSubmit("morning")})},{default:Object(r["lb"])((function(){return[o]})),_:1})]})),_:1}),Object(r["s"])(m,null,{default:Object(r["lb"])((function(){return[Object(r["s"])(g,{size:"mini",type:"primary",icon:"el-icon-search",onClick:t[4]||(t[4]=function(e){return p.onSubmit("afternoon")})},{default:Object(r["lb"])((function(){return[a]})),_:1})]})),_:1})]})),_:1},8,["model"])]),c,Object(r["s"])(O,{modelValue:f.dialogFormVisible,"onUpdate:modelValue":t[5]||(t[5]=function(e){return f.dialogFormVisible=e}),"before-close":p.closeDialog,width:"20%",top:"15%"},{footer:Object(r["lb"])((function(){return[Object(r["o"])("div",u,[Object(r["s"])(g,{size:"mini",type:"primary",onClick:p.closeDialog},{default:Object(r["lb"])((function(){return[l]})),_:1},8,["onClick"])])]})),default:Object(r["lb"])((function(){return[Object(r["s"])(w,null,{default:Object(r["lb"])((function(){return[s]})),_:1})]})),_:1},8,["modelValue","before-close"])])}Object(r["O"])();var f=n("1da1"),p=(n("6eba"),n("0d03"),n("4160"),n("159b"),n("d81d"),n("a9e3"),n("4795"),n("96cf"),n("c14a")),b=n("d95b"),h={data:function(){return{map:{},busInfoList:[],currentSelectedID:-1,currentSelectedPlate:"",currentSelectGPSSN:"",currentSelectedDate:this.getNowFormatDate(),preMarker:null,pointIdx:0,pointList:[],arrPoints:[],points:[],centerPoint:null,currentBound:null,carIcon_0:null,carIcon_1:null,carIcon_2:null,carIcon_3:null,carIcon_4:null,carIcon_5:null,carIcon_6:null,carIcon_7:null,currentLabel:null,timerId:null,dialogFormVisible:!1}},created:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.getBusInfos();case 1:case"end":return t.stop()}}),t)})))()},mounted:function(){this.loadJScript()},methods:{getBusInfos:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(p["getBusInfoList"])();case 2:n=t.sent,0===n.code&&(e.busInfoList=n.data.list,e.busInfoList&&e.busInfoList.length>0?(e.currentSelectedPlate=e.busInfoList[0].busPlate,e.currentSelectedID=e.busInfoList[0].ID,e.getBusInfo()):(e.currentSelectedPlate="",e.currentSelectedID=-1));case 4:case"end":return t.stop()}}),t)})))()},disabledDate:function(e){return e.getTime()>Date.now()-864e5},changeOption:function(e){this.currentSelectedID=e,this.getBusInfo()},getBusInfo:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(p["findBusInfo"])({ID:e.currentSelectedID});case 2:n=t.sent,0===n.code&&n.data.rebusInfo&&n.data.rebusInfo.gpsInfos[0]&&(e.currentSelectGPSSN=n.data.rebusInfo.gpsInfos[0].gpsSn);case 4:case"end":return t.stop()}}),t)})))()},getNowFormatDate:function(){var e=new Date;e-=864e5,e=new Date(e);var t="-",n=e.getFullYear(),r=e.getMonth()+1,i=e.getDate();r>=1&&r<=9&&(r="0"+r),i>=0&&i<=9&&(i="0"+i);var o=n+t+r+t+i;return o},loadJScript:function(){var e=this,t=document.createElement("script");t.type="text/javascript",t.src="//api.map.baidu.com/getscript?v=2.0&ak=qG1aM2UK80lGHVHKmHczRcmzBBOd8blK",t.onload=function(){console.log("script load success");var t=window.BMap;e.carIcon_0=new t.Icon("./images/car_0.png",new t.Size(48,48)),e.carIcon_1=new t.Icon("./images/car_1.png",new t.Size(48,48)),e.carIcon_2=new t.Icon("./images/car_2.png",new t.Size(48,48)),e.carIcon_3=new t.Icon("./images/car_3.png",new t.Size(48,48)),e.carIcon_4=new t.Icon("./images/car_4.png",new t.Size(48,48)),e.carIcon_5=new t.Icon("./images/car_5.png",new t.Size(48,48)),e.carIcon_6=new t.Icon("./images/car_6.png",new t.Size(48,48)),e.carIcon_7=new t.Icon("./images/car_7.png",new t.Size(48,48)),e.currentLabel=new t.Label("速度:0 KM/H",{offset:new t.Size(20,-10)}),e.currentLabel.setStyle({color:"#fff",backgroundColor:"#333333",border:"0",fontSize:"14px",width:"100px",opacity:"0.8",verticalAlign:"center",textAlign:"center",borderRadius:"2px",whiteSpace:"normal",wordWrap:"break-word",padding:"5px"})},document.body.appendChild(t);var n=document.createElement("script");n.type="text/javascript",n.src="//api.map.baidu.com/getscript?type=webgl&v=2.0&ak=qG1aM2UK80lGHVHKmHczRcmzBBOd8blK",n.onload=function(){console.log("scriptWebGl load success")},document.body.appendChild(n);var r=document.createElement("script");r.type="text/javascript",r.src="//api.map.baidu.com/library/TrackAnimation/src/TrackAnimation_min.js",r.onload=function(){console.log("trackscript load success")},document.body.appendChild(r)},transferPoint:function(e){var t=this,n=0,r=0;e.forEach((function(e){n!==e.lng&&r!==e.lat&&(t.arrPoints.push(new window.BMap.Point(e.lng,e.lat)),t.pointList.push(e),n=e.lng,r=e.lat)}))},driveline:function(e){this.map.addOverlay(new window.BMap.Polyline(e,{strokeColor:"#00ff00",strokeWeight:4,strokeOpacity:1}))},setZoom:function(){!1===this.currentBound.containsPoint(this.centerPoint)&&(this.map.centerAndZoom(this.centerPoint,15),this.currentBound=this.map.getBounds())},dynamicLine:function(){if(this.pointIdx!==this.arrPoints.length){null!=this.preMarker&&this.map.removeOverlay(this.preMarker);var e=null,t=Number(this.pointList[this.pointIdx].dir);0===t||360===t?e=new window.BMap.Marker(this.arrPoints[this.pointIdx],{icon:this.carIcon_0}):t>0&&t<90?e=new window.BMap.Marker(this.arrPoints[this.pointIdx],{icon:this.carIcon_1}):90===t?e=new window.BMap.Marker(this.arrPoints[this.pointIdx],{icon:this.carIcon_2}):t>90&&t<180?e=new window.BMap.Marker(this.arrPoints[this.pointIdx],{icon:this.carIcon_3}):180===t?e=new window.BMap.Marker(this.arrPoints[this.pointIdx],{icon:this.carIcon_4}):t>180&&t<270?e=new window.BMap.Marker(this.arrPoints[this.pointIdx],{icon:this.carIcon_5}):270===t?e=new window.BMap.Marker(this.arrPoints[this.pointIdx],{icon:this.carIcon_6}):t>270&&t<360&&(e=new window.BMap.Marker(this.arrPoints[this.pointIdx],{icon:this.carIcon_7})),this.currentLabel.setContent("速度:"+this.pointList[this.pointIdx].speed+" KM/H"),e.setLabel(this.currentLabel),this.map.addOverlay(e),this.preMarker=e,this.points.push(this.arrPoints[this.pointIdx]),this.centerPoint=this.arrPoints[this.pointIdx],this.setZoom(),this.driveline(this.points),this.pointIdx++,null!=this.timerId&&clearTimeout(this.timerId),this.timerId=setTimeout(this.dynamicLine,500)}else{var n=this.map.getViewport(this.points),r=n.center;this.map.centerAndZoom(r,13)}},showHistoryPath:function(e){this.transferPoint(e);var t=window.BMap;this.map=new t.Map("container"),this.map.centerAndZoom(this.arrPoints[0],15),this.map.setCurrentCity("南京"),this.map.enableScrollWheelZoom(!0),this.map.addControl(new t.NavigationControl),this.currentBound=this.map.getBounds(),this.dynamicLine()},initParameters:function(){this.pointIdx=0,this.arrPoints=[],this.points=[],this.map={},this.currentBound=null,this.preMarker=null,this.pointList=[],null!=this.timerId&&clearTimeout(this.timerId);var e=document.getElementById("container");e&&(e.style.display="block")},removeMap:function(){var e=document.getElementById("container");e&&(e.innerHTML="",e.style.display="none")},closeDialog:function(){this.dialogFormVisible=!1},onSubmit:function(e){var t=this;return Object(f["a"])(regeneratorRuntime.mark((function n(){var r,i,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.initParameters(),r="",i="","morning"===e?(r=t.currentSelectedDate+" 07:00:00",i=t.currentSelectedDate+" 11:00:00"):"afternoon"===e&&(r=t.currentSelectedDate+" 15:00:00",i=t.currentSelectedDate+" 18:00:00"),n.next=6,Object(b["track"])({gpsSn:t.currentSelectGPSSN,beginTime:r,endTime:i});case 6:o=n.sent,0===o.code&&o.data.track.length>0?t.showHistoryPath(o.data.track):(console.log("no data"),t.removeMap(),t.dialogFormVisible=!0);case 8:case"end":return n.stop()}}),n)})))()}}},m=(n("f9e2"),n("d959")),I=n.n(m);const g=I()(h,[["render",d],["__scopeId","data-v-e950f0bc"]]);t["default"]=g},a9e3:function(e,t,n){"use strict";var r=n("83ab"),i=n("da84"),o=n("94ca"),a=n("6eeb"),c=n("5135"),s=n("c6b6"),u=n("7156"),l=n("d9b5"),d=n("c04e"),f=n("d039"),p=n("7c73"),b=n("241c").f,h=n("06cf").f,m=n("9bf2").f,I=n("58a8").trim,g="Number",w=i[g],O=w.prototype,v=s(p(O))==g,j=function(e){if(l(e))throw TypeError("Cannot convert a Symbol value to a number");var t,n,r,i,o,a,c,s,u=d(e,"number");if("string"==typeof u&&u.length>2)if(u=I(u),t=u.charCodeAt(0),43===t||45===t){if(n=u.charCodeAt(2),88===n||120===n)return NaN}else if(48===t){switch(u.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+u}for(o=u.slice(2),a=o.length,c=0;c<a;c++)if(s=o.charCodeAt(c),s<48||s>i)return NaN;return parseInt(o,r)}return+u};if(o(g,!w(" 0o1")||!w("0b1")||w("+0x1"))){for(var _,S=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof S&&(v?f((function(){O.valueOf.call(n)})):s(n)!=g)?u(new w(j(t)),n,S):j(t)},y=r?b(w):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),k=0;y.length>k;k++)c(w,_=y[k])&&!c(S,_)&&m(S,_,h(w,_));S.prototype=O,O.constructor=S,a(i,g,S)}},c14a:function(e,t,n){"use strict";n.r(t),n.d(t,"createBusInfo",(function(){return i})),n.d(t,"deleteBusInfo",(function(){return o})),n.d(t,"deleteBusInfoByIds",(function(){return a})),n.d(t,"updateBusInfo",(function(){return c})),n.d(t,"findBusInfo",(function(){return s})),n.d(t,"getBusInfoList",(function(){return u}));var r=n("b775"),i=function(e){return Object(r["default"])({url:"/busInfo/createBusInfo",method:"post",data:e})},o=function(e){return Object(r["default"])({url:"/busInfo/deleteBusInfo",method:"delete",data:e})},a=function(e){return Object(r["default"])({url:"/busInfo/deleteBusInfoByIds",method:"delete",data:e})},c=function(e){return Object(r["default"])({url:"/busInfo/updateBusInfo",method:"put",data:e})},s=function(e){return Object(r["default"])({url:"/busInfo/findBusInfo",method:"get",params:e})},u=function(e){return Object(r["default"])({url:"/busInfo/getBusInfoList",method:"get",params:e})}},d95b:function(e,t,n){"use strict";n.r(t),n.d(t,"getLocation",(function(){return i})),n.d(t,"track",(function(){return o}));var r=n("b775"),i=function(e){return Object(r["default"])({url:"/gps/location",method:"get",params:e})},o=function(e){return Object(r["default"])({url:"/gps/track",method:"get",params:e})}},f9e2:function(e,t,n){"use strict";n("2fec")}}]);